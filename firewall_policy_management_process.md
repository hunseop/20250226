# 방화벽 정책 관리 프로세스

## 태스크 번호 재정의 (실제 작업 순서 기준)

1. **신청번호 파싱** (parse_request_type)
2. **신청번호 추출** (extract_request_id)
3. **MIS ID 추가** (add_mis_id)
4. **신청정보 추가** (add_request_info)
5. **예외처리 - 팔로알토** (paloalto_exception)
6. **예외처리 - 시큐아이** (secui_exception)
7. **중복정책 분류** (organize_redundant_file)
8. **중복정책 상태 추가** (add_duplicate_status)
9. **미사용 정책 정보 추가** (add_usage_status)
10. **정리대상 분류** (notice_file_organization)

## 파일 명명 규칙
파일명 기본 형식: `날짜_방화벽이름_속성.xlsx`
예: `20231101_PaloAlto_정책.xlsx`

## 전체 프로세스 흐름

1. **방화벽 정책 추출** (외부 작업)
   - 작업: 방화벽에서 정책 데이터 추출
   - 결과: `날짜_방화벽이름_정책.xlsx`

2. **방화벽 중복 정책 추출** (외부 작업)
   - 작업: 중복된 정책 식별
   - 결과: `날짜_방화벽이름_중복.xlsx`

3. **신청번호 파싱** (태스크 1)
   - 입력: `날짜_방화벽이름_정책.xlsx`, `날짜_방화벽이름_중복.xlsx`
   - 작업: Description 필드에서 신청번호 등 정보 추출
   - 결과: `날짜_방화벽이름_정책_v1.xlsx`, `날짜_방화벽이름_중복_v1.xlsx`

4. **신청번호 추출** (태스크 2)
   - 입력: `날짜_방화벽이름_정책_v1.xlsx`
   - 작업: 신청번호(Request ID)만 추출하여 타부서 전달
   - 결과: `request_id_날짜_방화벽이름_정책_v1.xlsx`
   - 참고: 타부서로부터 신청 정보 파일 수신 대기

5. **MIS ID 추가** (태스크 3)
   - 입력: `날짜_방화벽이름_정책_v1.xlsx`, MIS ID CSV 파일
   - 작업: 정책에 누락된 MIS ID 정보 추가
   - 결과: `날짜_방화벽이름_정책_v2.xlsx`

6. **신청정보 추가** (태스크 4)
   - 입력: `날짜_방화벽이름_정책_v2.xlsx`, 타부서 제공 신청 정보 파일
   - 작업: 신청번호 기반으로 타부서 제공 정보 매핑
   - 결과: `날짜_방화벽이름_정책_v3.xlsx`

7. **예외처리** (태스크 5 또는 6)
   - 입력: `날짜_방화벽이름_정책_v3.xlsx`
   - 작업: 방화벽 종류에 따라 예외처리 수행
     - 팔로알토: 태스크 5
     - 시큐아이: 태스크 6
   - 결과: `날짜_방화벽이름_정책_v4.xlsx`

8. **중복정책 분류** (태스크 7)
   - 입력: `날짜_방화벽이름_중복_v1.xlsx`
   - 작업: 중복정책을 공지용/삭제용으로 분류
   - 결과: 
     - `날짜_방화벽이름_중복_v1_정리.xlsx`: 전체 분류 결과
     - `날짜_방화벽이름_중복_v1_공지.xlsx`: 공지 대상 정책
     - `날짜_방화벽이름_중복_v1_삭제.xlsx`: 삭제 대상 정책

9. **중복정책 상태 추가** (태스크 8)
   - 입력: `날짜_방화벽이름_정책_v4.xlsx`, `날짜_방화벽이름_중복_v1_정리.xlsx`
   - 작업: 중복정책 분류 결과를 정책 파일에 추가
   - 결과: `날짜_방화벽이름_정책_v5.xlsx`

10. **미사용 정책 정보 추가** (태스크 9)
    - 입력: `날짜_방화벽이름_정책_v5.xlsx`, 미사용 정책 정보 파일(외부 작업)
    - 작업: 미사용 정책 정보를 정책 파일에 추가
    - 결과: `날짜_방화벽이름_정책_vf.xlsx` (최종 버전)

11. **정리대상 분류** (태스크 10)
    - 입력: `날짜_방화벽이름_정책_vf.xlsx`
    - 작업: 최종 정책 파일을 여러 기준으로 분류하여 공지용 파일 생성
    - 결과:
      - `날짜_방화벽이름_정책_vf_기간만료(공지용).xlsx`: 만료된 사용 정책
      - `날짜_방화벽이름_정책_vf_만료_미사용정책(공지용).xlsx`: 만료된 미사용 정책
      - `날짜_방화벽이름_정책_vf_장기미사용정책(공지용).xlsx`: 미만료 미사용 정책
      - `날짜_방화벽이름_정책_vf_이력없는_미사용정책.xlsx`: 이력 없는 미사용 정책

## 작업 요약표

| 단계 | 태스크 번호 | 함수명 | 작업 내용 | 입력 파일 | 출력 파일 |
|------|------------|--------|----------|-----------|-----------|
| 1 | 외부 작업 | - | 방화벽 정책 추출 | - | 날짜_방화벽이름_정책.xlsx |
| 2 | 외부 작업 | - | 중복 정책 추출 | - | 날짜_방화벽이름_중복.xlsx |
| 3 | 태스크 1 | parse_request_type | 신청번호 파싱 | 날짜_방화벽이름_정책.xlsx<br>날짜_방화벽이름_중복.xlsx | 날짜_방화벽이름_정책_v1.xlsx<br>날짜_방화벽이름_중복_v1.xlsx |
| 4 | 태스크 2 | extract_request_id | 신청번호 추출 | 날짜_방화벽이름_정책_v1.xlsx | request_id_날짜_방화벽이름_정책_v1.xlsx |
| 5 | 태스크 3 | add_mis_id | MIS ID 추가 | 날짜_방화벽이름_정책_v1.xlsx<br>MIS ID CSV 파일 | 날짜_방화벽이름_정책_v2.xlsx |
| 6 | 태스크 4 | add_request_info | 신청정보 추가 | 날짜_방화벽이름_정책_v2.xlsx<br>타부서 제공 신청 정보 파일 | 날짜_방화벽이름_정책_v3.xlsx |
| 7 | 태스크 5/6 | paloalto_exception<br>secui_exception | 예외처리 | 날짜_방화벽이름_정책_v3.xlsx | 날짜_방화벽이름_정책_v4.xlsx |
| 8 | 태스크 7 | organize_redundant_file | 중복정책 분류 | 날짜_방화벽이름_중복_v1.xlsx | 날짜_방화벽이름_중복_v1_정리.xlsx<br>날짜_방화벽이름_중복_v1_공지.xlsx<br>날짜_방화벽이름_중복_v1_삭제.xlsx |
| 9 | 태스크 8 | add_duplicate_status | 중복정책 상태 추가 | 날짜_방화벽이름_정책_v4.xlsx<br>날짜_방화벽이름_중복_v1_정리.xlsx | 날짜_방화벽이름_정책_v5.xlsx |
| 10 | 태스크 9 | add_usage_status | 미사용 정책 정보 추가 | 날짜_방화벽이름_정책_v5.xlsx<br>미사용 정책 정보 파일 | 날짜_방화벽이름_정책_vf.xlsx |
| 11 | 태스크 10 | notice_file_organization | 정리대상 분류 | 날짜_방화벽이름_정책_vf.xlsx | 날짜_방화벽이름_정책_vf_기간만료(공지용).xlsx<br>날짜_방화벽이름_정책_vf_만료_미사용정책(공지용).xlsx<br>날짜_방화벽이름_정책_vf_장기미사용정책(공지용).xlsx<br>날짜_방화벽이름_정책_vf_이력없는_미사용정책.xlsx | 